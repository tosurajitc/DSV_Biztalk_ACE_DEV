<?xml version="1.0" encoding="UTF-8"?>
<ecore:EPackage xmi:version="2.0" 
    xmlns:xmi="http://www.omg.org/XMI" 
    xmlns:ComIbmCompute.msgnode="ComIbmCompute.msgnode" 
    xmlns:ComIbmSOAPRequest.msgnode="ComIbmSOAPRequest.msgnode" 
    xmlns:ComIbmXslMqsi.msgnode="ComIbmXslMqsi.msgnode" 
    xmlns:ecore="http://www.eclipse.org/emf/2002/Ecore" 
    xmlns:eflow="http://www.ibm.com/wbi/2005/eflow" 
    xmlns:epis_common_flows_lib_MQInput.subflow="epis/common/flows/lib/MQInput.subflow" 
    xmlns:epis_common_flows_lib_MQOutput.subflow="epis/common/flows/lib/MQOutput.subflow"
    xmlns:epis_compression_lib_GZipCompressAndB64EncodeElement.subflow="epis/compression/lib/GZipCompressAndB64EncodeElement.subflow" 
    xmlns:epis_enrichment_lib_EPIS_MessageEnrichment.subflow="epis/enrichment/lib/EPIS_MessageEnrichment.subflow" 
    xmlns:utility="http://www.ibm.com/wbi/2005/eflow_utility" 
    nsURI="{FLOW_NAME}.msgflow" 
    nsPrefix="{FLOW_NAME}.msgflow">

  <eClassifiers xmi:type="eflow:FCMComposite" name="FCMComposite_1" nodeLayoutStyle="RECTANGLE">
    <eSuperTypes href="http://www.ibm.com/wbi/2005/eflow#//FCMBlock"/>
    
    <!-- Template Properties - Replace with actual values -->
    <eStructuralFeatures xmi:type="ecore:EAttribute" xmi:id="Property.INPUT_QUEUE" name="INPUT_QUEUE" lowerBound="1" defaultValueLiteral="{INPUT_QUEUE_NAME}">
      <eType xmi:type="ecore:EDataType" href="http://www.eclipse.org/emf/2002/Ecore#//EString"/>
    </eStructuralFeatures>
    
    <eStructuralFeatures xmi:type="ecore:EAttribute" xmi:id="Property.INPUT_MSG_PARSING" name="INPUT_MSG_PARSING" defaultValueLiteral="XMLNSC">
      <eType xmi:type="ecore:EDataType" href="http://www.eclipse.org/emf/2002/Ecore#//EString"/>
    </eStructuralFeatures>
    
    <eStructuralFeatures xmi:type="ecore:EAttribute" xmi:id="Property.COMPRESS_MSG_SIZE" name="COMPRESS_MSG_SIZE" lowerBound="1" defaultValueLiteral="103809024">
      <eType xmi:type="ecore:EDataType" href="http://www.eclipse.org/emf/2002/Ecore#//EInt"/>
    </eStructuralFeatures>
    
    <eStructuralFeatures xmi:type="ecore:EAttribute" xmi:id="Property.STYLESHEET_NAME" name="STYLESHEET_NAME" defaultValueLiteral="{XSL_STYLESHEET_NAME}">
      <eType xmi:type="ecore:EDataType" href="http://www.eclipse.org/emf/2002/Ecore#//EString"/>
    </eStructuralFeatures>
    
    <eStructuralFeatures xmi:type="ecore:EAttribute" xmi:id="Property.IS_XSLTRANSFORM" name="IS_XSLTRANSFORM" lowerBound="1" defaultValueLiteral="true">
      <eType xmi:type="ecore:EDataType" href="http://www.eclipse.org/emf/2002/Ecore#//EBoolean"/>
    </eStructuralFeatures>
    
    <eStructuralFeatures xmi:type="ecore:EAttribute" xmi:id="Property.IS_BEFORE_ENRICHMENT" name="IS_BEFORE_ENRICHMENT" lowerBound="1" defaultValueLiteral="true">
      <eType xmi:type="ecore:EDataType" href="http://www.eclipse.org/emf/2002/Ecore#//EBoolean"/>
    </eStructuralFeatures>
    
    <eStructuralFeatures xmi:type="ecore:EAttribute" xmi:id="Property.IS_AFTER_ENRICHMENT" name="IS_AFTER_ENRICHMENT" lowerBound="1" defaultValueLiteral="false">
      <eType xmi:type="ecore:EDataType" href="http://www.eclipse.org/emf/2002/Ecore#//EBoolean"/>
    </eStructuralFeatures>
    
    <eStructuralFeatures xmi:type="ecore:EAttribute" xmi:id="Property.BEFORE_INPUT_DIR" name="BEFORE_INPUT_DIR" defaultValueLiteral="{APP_NAME}\{FLOW_NAME}\enrichment">
      <eType xmi:type="ecore:EDataType" href="http://www.eclipse.org/emf/2002/Ecore#//EString"/>
    </eStructuralFeatures>
    
    <eStructuralFeatures xmi:type="ecore:EAttribute" xmi:id="Property.BEFORE_FILE_NAME" name="BEFORE_FILE_NAME" defaultValueLiteral="BeforeEnrichmentConf.json">
      <eType xmi:type="ecore:EDataType" href="http://www.eclipse.org/emf/2002/Ecore#//EString"/>
    </eStructuralFeatures>
    
    <eStructuralFeatures xmi:type="ecore:EAttribute" xmi:id="Property.AFTER_INPUT_DIR" name="AFTER_INPUT_DIR" defaultValueLiteral="{APP_NAME}\{FLOW_NAME}\enrichment">
      <eType xmi:type="ecore:EDataType" href="http://www.eclipse.org/emf/2002/Ecore#//EString"/>
    </eStructuralFeatures>
    
    <eStructuralFeatures xmi:type="ecore:EAttribute" xmi:id="Property.AFTER_FILE_NAME" name="AFTER_FILE_NAME" defaultValueLiteral="AfterEnrichmentConf.json">
      <eType xmi:type="ecore:EDataType" href="http://www.eclipse.org/emf/2002/Ecore#//EString"/>
    </eStructuralFeatures>

    <!-- Branding and Graphics -->
    <translation xmi:type="utility:TranslatableString" key="{FLOW_NAME}" bundleName="{FLOW_NAME}" pluginId="{APP_NAME}_Developer"/>
    <colorGraphic16 xmi:type="utility:GIFFileGraphic" resourceName="platform:/plugin/{APP_NAME}_Developer/icons/full/obj16/{FLOW_NAME}.gif"/>
    <colorGraphic32 xmi:type="utility:GIFFileGraphic" resourceName="platform:/plugin/{APP_NAME}_Developer/icons/full/obj30/{FLOW_NAME}.gif"/>
    
    <composition>
      <!-- STANDARD 6 COMPUTE MODULES -->
      <!-- 1. INPUT EVENT MESSAGE -->
      <nodes xmi:type="ComIbmCompute.msgnode:FCMComposite_1" xmi:id="FCMComposite_1_1" 
            location="100,100" 
            computeExpression="{FLOW_NAME}_InputEventMessage">
        <translation xmi:type="utility:ConstantString" string="InputEventMessage"/>
      </nodes>

      <!-- 2. MAIN COMPUTE (Business Logic) -->
      <nodes xmi:type="ComIbmCompute.msgnode:FCMComposite_1" xmi:id="FCMComposite_1_2" 
            location="300,100" 
            computeExpression="{FLOW_NAME}_Compute">
        <translation xmi:type="utility:ConstantString" string="Compute"/>
      </nodes>

      <!-- 3. AFTER ENRICHMENT -->
      <nodes xmi:type="ComIbmCompute.msgnode:FCMComposite_1" xmi:id="FCMComposite_1_3" 
            location="500,100" 
            computeExpression="{FLOW_NAME}_AfterEnrichment">
        <translation xmi:type="utility:ConstantString" string="AfterEnrichment"/>
      </nodes>

      <!-- 4. OUTPUT EVENT MESSAGE -->
      <nodes xmi:type="ComIbmCompute.msgnode:FCMComposite_1" xmi:id="FCMComposite_1_4" 
            location="700,100" 
            computeExpression="{FLOW_NAME}_OutputEventMessage">
        <translation xmi:type="utility:ConstantString" string="OutputEventMessage"/>
      </nodes>

      <!-- 5. AFTER EVENT MESSAGE -->
      <nodes xmi:type="ComIbmCompute.msgnode:FCMComposite_1" xmi:id="FCMComposite_1_5" 
            location="900,100" 
            computeExpression="{FLOW_NAME}_AfterEventMsg">
        <translation xmi:type="utility:ConstantString" string="AfterEventMsg"/>
      </nodes>

      <!-- 6. FAILURE HANDLER -->
      <nodes xmi:type="ComIbmCompute.msgnode:FCMComposite_1" xmi:id="FCMComposite_1_6" 
            location="500,300" 
            computeExpression="{FLOW_NAME}_Failure">
        <translation xmi:type="utility:ConstantString" string="Failure"/>
      </nodes>

      <!-- CONNECTIONS SECTION -->
      <!-- STANDARD 6-MODULE FLOW CONNECTIONS -->
      <!-- 1. Input → Compute -->
      <connections xmi:type="eflow:FCMConnection" xmi:id="FCMConnection_1" 
                  targetNode="FCMComposite_1_2" sourceNode="FCMComposite_1_1" 
                  sourceTerminalName="OutTerminal.out" targetTerminalName="InTerminal.in"/>

      <!-- 2. Compute → AfterEnrichment -->
      <connections xmi:type="eflow:FCMConnection" xmi:id="FCMConnection_2" 
                  targetNode="FCMComposite_1_3" sourceNode="FCMComposite_1_2" 
                  sourceTerminalName="OutTerminal.out" targetTerminalName="InTerminal.in"/>

      <!-- 3. AfterEnrichment → OutputEvent -->
      <connections xmi:type="eflow:FCMConnection" xmi:id="FCMConnection_3" 
                  targetNode="FCMComposite_1_4" sourceNode="FCMComposite_1_3" 
                  sourceTerminalName="OutTerminal.out" targetTerminalName="InTerminal.in"/>

      <!-- 4. OutputEvent → AfterEvent -->
      <connections xmi:type="eflow:FCMConnection" xmi:id="FCMConnection_4" 
                  targetNode="FCMComposite_1_5" sourceNode="FCMComposite_1_4" 
                  sourceTerminalName="OutTerminal.out" targetTerminalName="InTerminal.in"/>

      <!-- ERROR HANDLING CONNECTIONS -->
      <!-- Compute → Failure -->
      <connections xmi:type="eflow:FCMConnection" xmi:id="FCMConnection_5" 
                  targetNode="FCMComposite_1_6" sourceNode="FCMComposite_1_2" 
                  sourceTerminalName="OutTerminal.failure" targetTerminalName="InTerminal.in"/>

      <!-- AfterEnrichment → Failure -->
      <connections xmi:type="eflow:FCMConnection" xmi:id="FCMConnection_6" 
                  targetNode="FCMComposite_1_6" sourceNode="FCMComposite_1_3" 
                  sourceTerminalName="OutTerminal.failure" targetTerminalName="InTerminal.in"/>
    </composition>

    <propertyOrganizer>
      <propertyDescriptor groupName="Group.COMPRESSION" configurable="true" userDefined="true" describedAttribute="Property.COMPRESS_MSG_SIZE">
        <propertyName xmi:type="utility:TranslatableString" key="Property.COMPRESS_MSG_SIZE" bundleName="epis/common/flows/lib/MQInput" pluginId="EPIS_CommonFlows_Lib"/>
        <propertyDescriptor groupName="Group.INPUT" propertyEditor="com.ibm.etools.mft.ibmnodes.editors.MRMessageDomainPropertyEditor" describedAttribute="Property.INPUT_MSG_PARSING">
          <propertyName xmi:type="utility:TranslatableString" key="Property.INPUT_MSG_PARSING" bundleName="epis/common/flows/lib/MQInput" pluginId="EPIS_CommonFlows_Lib"/>
          <propertyDescriptor groupName="Group.INPUT" propertyEditor="com.ibm.etools.mft.ibmnodes.editors.mq.MQQueueNameEditor" configurable="true" describedAttribute="Property.INPUT_QUEUE">
            <propertyName xmi:type="utility:TranslatableString" key="Property.INPUT_QUEUE" bundleName="epis/common/flows/lib/MQInput" pluginId="EPIS_CommonFlows_Lib"/>
            <propertyDescriptor groupName="Group.BEFORE_ENRICHMENT" propertyEditor="com.ibm.etools.mft.ibmnodes.editors.file.FileReadNodeFilePropertyEditor" configurable="true" describedAttribute="Property.BEFORE_FILE_NAME">
              <propertyName xmi:type="utility:TranslatableString" key="Property.BEFORE_FILE_NAME" bundleName="ComIbmFileRead" pluginId="com.ibm.etools.mft.ibmnodes.definitions"/>
              <propertyDescriptor groupName="Group.BEFORE_ENRICHMENT" propertyEditor="com.ibm.etools.mft.ibmnodes.editors.file.FileNodesBrowseDirPropertyEditor" configurable="true" describedAttribute="Property.BEFORE_INPUT_DIR">
                <propertyName xmi:type="utility:TranslatableString" key="Property.BEFORE_INPUT_DIR" bundleName="ComIbmFileRead" pluginId="com.ibm.etools.mft.ibmnodes.definitions"/>
              </propertyDescriptor>
            </propertyDescriptor>
          </propertyDescriptor>
        </propertyDescriptor>
      </propertyDescriptor>
    </propertyOrganizer>

    <attributeLinks promotedAttribute="Property.COMPRESS_MSG_SIZE" overriddenNodes="FCMComposite_1_2">
      <overriddenAttribute href="epis/common/flows/lib/MQInput.subflow#Property.COMPRESS_MSG_SIZE"/>
    </attributeLinks>
    <attributeLinks promotedAttribute="Property.INPUT_MSG_PARSING" overriddenNodes="FCMComposite_1_2">
      <overriddenAttribute href="epis/common/flows/lib/MQInput.subflow#Property.INPUT_MSG_PARSING"/>
    </attributeLinks>
    <attributeLinks promotedAttribute="Property.INPUT_QUEUE" overriddenNodes="FCMComposite_1_2">
      <overriddenAttribute href="epis/common/flows/lib/MQInput.subflow#Property.INPUT_QUEUE"/>
    </attributeLinks>
    <attributeLinks promotedAttribute="Property.BEFORE_FILE_NAME" overriddenNodes="FCMComposite_1_3">
      <overriddenAttribute href="epis/enrichment/lib/EPIS_MessageEnrichment.subflow#Property.filenamePattern"/>
    </attributeLinks>
    <attributeLinks promotedAttribute="Property.BEFORE_INPUT_DIR" overriddenNodes="FCMComposite_1_3">
      <overriddenAttribute href="epis/enrichment/lib/EPIS_MessageEnrichment.subflow#Property.inputDirectory"/>
    </attributeLinks>

    <stickyBoard/>
  </eClassifiers>
</ecore:EPackage>